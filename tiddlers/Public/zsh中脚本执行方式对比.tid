created: 20241224071116406
creator: uzvg
description: zshä¸­çš„äº”ç§ä¸åŒè„šæœ¬çš„å¯åŠ¨æ–¹å¼ï¼Œä¸åŒå¯åŠ¨æ–¹å¼ï¼Œä¼šå¯¼è‡´zshå®ä¾‹åŠ è½½ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œè¿›è€Œå½±å“åˆ°è„šæœ¬çš„è¿è¡Œç¯å¢ƒã€‚
modified: 20250317090326803
modifier: uzvg
progress: Linking
rating: Valuable
tags: zsh PermanentNotes
title: zshä¸­è„šæœ¬æ‰§è¡Œæ–¹å¼å¯¹æ¯”
type: text/vnd.tiddlywiki
visibility: Public

zshä¸­äº”ç§ä¸åŒçš„è„šæœ¬æ‰§è¡Œæ–¹å¼åŠå…¶ä¸»è¦åŒºåˆ«ï¼š

|tc-max-width|k
| !æ‰§è¡Œæ–¹å¼ | !ç‰¹ç‚¹ |
|`./script.zsh` |<li>åœ¨æ–°çš„å­ shell ä¸­ä»¥`non-login Shell`æ–¹å¼æ‰§è¡Œ</li><li>ä¸ä¼šå½±å“å½“å‰ shell çš„ç¯å¢ƒ</li><li>''éœ€è¦æ‰§è¡Œæƒé™''</li><li>''ä¸ä¼š''åŠ è½½`.zlogin`ã€`.zprofile`ã€`.zlogout`ç­‰é…ç½®æ–‡ä»¶ã€‚</li> |
|`source script.zsh`æˆ–`. script.zsh` |<li>åœ¨å½“å‰ shell ä¸­æ‰§è¡Œ</li><li>ä¼šå½±å“å½“å‰ shell çš„ç¯å¢ƒ</li><li>''ä¸éœ€è¦''æ‰§è¡Œæƒé™</li><li>''ç»§æ‰¿''å½“å‰ shell çš„æ‰€æœ‰ç¯å¢ƒå’Œé…ç½®</li> |
|`zsh script.zsh` |<li>åœ¨æ–°çš„''å­shell''ä¸­ä»¥`non-login Shell`çš„æ–¹å¼æ‰§è¡Œ</li><li>''ä¸ä¼šå½±å“''å½“å‰shellçš„ç¯å¢ƒ</li><li>''ä¸éœ€è¦''æ‰§è¡Œæƒé™</li><li>''ä¸ä¼š''åŠ è½½`.zlogin`ã€`.zprofile`ã€`.zlogout`ç­‰é…ç½®æ–‡ä»¶ã€‚</li> |
|`zsh -l script.zsh` |<li>åœ¨æ–°çš„''å­shell''ä¸­ä»¥`login shell`çš„æ–¹å¼æ‰§è¡Œ</li><li>''ä¸ä¼šå½±å“''å½“å‰shellçš„ç¯å¢ƒ</li><li>''ä¸éœ€è¦''æ‰§è¡Œæƒé™</li><li>''ä¼š''åŠ è½½`.zlogin`ã€`.zprofile`ã€`.zlogout`ç­‰é…ç½®æ–‡ä»¶ã€‚</li> |
|`zsh -f script.zsh` |<li>åœ¨æ–°çš„''å­shell''ä¸­ä¸åŠ è½½ä»»ä½•é…ç½®æ–‡ä»¶æ‰§è¡Œè„šæœ¬</li><li>''ä¸ä¼šå½±å“''å½“å‰shellçš„ç¯å¢ƒ</li><li>''ä¸éœ€è¦''æ‰§è¡Œæƒé™</li><li>åªåŠ è½½ `/etc/zshenv`æ–‡ä»¶</li> |

<<twks-tip """
`zsh -f` å‘½ä»¤ç”¨äºå¯åŠ¨ Zshï¼ˆZ Shellï¼‰è€Œä¸åŠ è½½ä»»ä½•é…ç½®æ–‡ä»¶ã€‚è¿™æ„å‘³ç€åœ¨ä½¿ç”¨ `-f` é€‰é¡¹æ—¶ï¼ŒZsh å°†ä¸ä¼šè¯»å–é™¤äº†`/etc/zshenv`æ–‡ä»¶ä»¥å¤–çš„ä»»ä½•æ–‡ä»¶ï¼Œä½†æ˜¯ï¼Œçˆ¶Shellçš„ç¯å¢ƒå˜é‡ï¼Œ''ä»ç„¶ä¼šè¢«ç»§æ‰¿''ï¼Œå…·ä½“è¯·çœ‹[[zsh -få¯åŠ¨çš„å­Shellçš„ç‰¹ç‚¹]]ã€‚">>

```zsh
MYVAR="hello"
zsh -f -c 'echo $MYVAR'
```

""">>

<<twks-caution """
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œzshä¸­ä¸åŒçš„è„šæœ¬æ‰§è¡Œæ–¹å¼ä¼šå½±å“åˆ°è„šæœ¬æ‰§è¡Œå‰zshè¯»å–çš„æ–‡ä»¶ï¼Œè¿›è€Œå½±å“åˆ°zshè„šæœ¬è¿è¡Œçš„ç¯å¢ƒã€‚
""">>

!! æ‰§è¡Œæ–¹å¼å¯¹è„šæœ¬è¿è¡Œç¯å¢ƒçš„å½±å“ï¼š

ä¸ºäº†æµ‹è¯•è„šæœ¬æ‰§è¡Œæ–¹å¼å¯¹è„šæœ¬è¿è¡Œç¯å¢ƒçš„å½±å“ï¼Œæˆ‘ä»¬å¯ä»¥åšå¦‚ä¸‹æµ‹è¯•ï¼š

1. åœ¨`.zlogin`æ–‡ä»¶ä¸­å®šä¹‰å˜é‡ï¼š

```
name="Henry"
```

2. åˆ›å»ºä¸€ä¸ªè„šæœ¬æ–‡ä»¶`test-environment.zsh`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```zsh
print "Your name is $name".
```

3. ä¸ºè¯¥å‘½ä»¤æ·»åŠ æ‰§è¡Œæƒé™ï¼š

```zsh
chmod +x test-environment.zsh
```

3. åˆ†åˆ«ä»¥å¦‚ä¸‹ä¸åŒçš„ç¯å¢ƒåšæµ‹è¯•ï¼š

; åœ¨non-login shellä¸­ï¼š

| !æ‰§è¡Œæ–¹å¼ | !æ‰§è¡Œç»“æœ | !å¤‡æ³¨ |
|`source test-environment.zsh` |Your name is .||
|`. ./test-environment.zsh` |Your name is .||
|`zsh test-environment.zsh` |Your name is .||
|`zsh -l test-environment.zsh` |Your name is Henry.|`zsh -l`ä¼šä»¥login Shellçš„æ–¹å¼æ‰§è¡Œè„šæœ¬ï¼Œæ‰€ä»¥ä¼šè¯»å–`.zlogin`æ–‡ä»¶ï¼Œèƒ½è·å¾—å˜é‡çš„å€¼ã€‚|
|`zsh -f test-environment.zsh` |Your name is .|`zsh -f`åªåŠ è½½`/etc/zshenv`æ–‡ä»¶ï¼Œä¸åŠ è½½`~/.zlogin`æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸èƒ½è·å¾—å˜é‡çš„å€¼ã€‚|

; åœ¨login shellä¸­ï¼š

| !æ‰§è¡Œæ–¹å¼ | !æ‰§è¡Œç»“æœ | !å¤‡æ³¨ |
|`source test-environment.zsh` |Your name is Henry .|å› ä¸ºæ˜¯å½“å‰Shellæœ¬èº«å°±æ˜¯`login shell`ï¼Œä½¿ç”¨sourceæ‰§è¡Œè„šæœ¬ï¼Œä¼šåœ¨å½“å‰Shellä¸­æ‰§è¡Œï¼Œæ‰€ä»¥èƒ½è·å¾—å˜é‡çš„å€¼ã€‚|
|`. ./test-environment.zsh` |Your name is Henry.|è·Ÿsourceæ‰§è¡Œè„šæœ¬çš„ç»“æœä¸€æ ·ã€‚|
|`zsh test-environment.zsh` |Your name is .|åœ¨å­Shellä¸­æ‰§è¡Œè„šæœ¬ï¼Œå­Shellæ˜¯ä¸€ä¸ª`non-login`Shellï¼Œæ‰€ä»¥æ— æ³•è·å¾—å˜é‡çš„å€¼ã€‚|
|`zsh -l test-environment.zsh` |Your name is Henry.|`zsh -l`ä¼šä»¥login Shellçš„æ–¹å¼æ‰§è¡Œè„šæœ¬ï¼Œæ‰€ä»¥ä¼šè¯»å–`.zlogin`æ–‡ä»¶ï¼Œèƒ½è·å¾—å˜é‡çš„å€¼ã€‚|
|`zsh -f test-environment.zsh` |Your name is .|`zsh -f`åªåŠ è½½`/etc/zshenv`æ–‡ä»¶ï¼Œä¸åŠ è½½`~/.zlogin`æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸èƒ½è·å¾—å˜é‡çš„å€¼ã€‚|

<<rememberq "20241225021427604"
	"ä½¿ç”¨`source <script>`çš„æ–¹å¼æ‰§è¡Œè„šæœ¬ï¼Œä¼šå½±å“å½“å‰Shellè¿è¡Œç¯å¢ƒå—ï¼Ÿ"
	"ä¼šã€‚ä½¿ç”¨`source`æ‰§è¡Œè„šæœ¬ï¼Œä¸€æ–¹é¢ä¼šç»§æ‰¿å½“å‰Shellçš„è¿è¡Œç¯å¢ƒï¼Œä¸€æ–¹é¢ä¼šä¿®æ”¹å½“å‰Shellçš„è¿è¡Œç¯å¢ƒã€‚">>

<<rememberq "20241225021658709"
	"ä½¿ç”¨`source`æ‰§è¡Œè„šæœ¬æ–‡ä»¶ï¼Œè„šæœ¬æ–‡ä»¶éœ€è¦æ‰§è¡Œæƒé™å—ï¼Ÿ"
	"ä¸éœ€è¦ã€‚">>

<<rememberq "20241225021732903"
	"`source <script>`è·Ÿ`. <path/to/script>`æœ‰ä»€ä¹ˆä¸åŒå—ï¼Ÿ"
	"ä¸¤è€…çš„æ‰§è¡Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚">>

<<rememberq "20241225021822569"
	"`. <path/to/script>`è·Ÿ`./<path/to/script>`æœ‰ä»€ä¹ˆä¸åŒå—ï¼Ÿ"
	"å‰è€…ç›¸å½“äºä½¿ç”¨`source`å‘½ä»¤æ‰§è¡Œè„šæœ¬ï¼Œä¼šç»§æ‰¿å¹¶ä¿®æ”¹å½“å‰Shellè¿è¡Œç¯å¢ƒï¼›åè€…æ˜¯åœ¨å­Shellä¸­ä»¥`non-login`çš„æ–¹å¼æ‰§è¡Œè„šæœ¬ã€‚ä¸ä¼šå½±å“å½“å‰Shellè¿è¡Œç¯å¢ƒã€‚">>

<<rememberq "20241225023211302"
	"`./<path/to/script>`ä»¥`non-login`çš„æ–¹å¼æ‰§è¡Œè„šæœ¬ï¼Œå®ƒä¼šä¸ä¼šç»§æ‰¿çˆ¶Shellçš„è¿è¡Œç¯å¢ƒï¼Ÿ"
	"åœ¨Shellä¸­ï¼Œå­Shellä¼šç»§æ‰¿çˆ¶Shellçš„ç¯å¢ƒå˜é‡ï¼Œä½†å¹¶éæ‰€æœ‰å˜é‡ã€‚">>

<<twks-tip "è¯¦ç»†æƒ…å†µï¼Œè¯·çœ‹ğŸ‘‰[[å­Shellä¼šç»§æ‰¿çˆ¶Shellçš„ç¯å¢ƒå˜é‡]]ã€‚">>

<<rememberq "20241225023726842"
	"ä½¿ç”¨`zsh <script>`å‘½ä»¤è·Ÿ`./<script>å‘½ä»¤æœ‰ä»€ä¹ˆä¸åŒå—ï¼Ÿ`"
	"å‰è€…è„šæœ¬æ–‡ä»¶ä¸éœ€è¦æ‰§è¡Œæƒé™ï¼›åè€…éœ€è¦æ‰§è¡Œæƒé™ã€‚">>

<<rememberq "20241225025057231"
	"`zsh -l <script>`æ‰§è¡Œè„šæœ¬çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ"
	"ä»¥`login Shell`çš„æ–¹å¼ç™»å½•è„šæœ¬ï¼Œä¼šè¯»å–`.zprofile`ï¼Œ`.zlogin`æ–‡ä»¶ã€‚">>

<<rememberq "20241225025255945"
	"ä½¿ç”¨`zsh -f`å‘½ä»¤è„šæœ¬æ–‡ä»¶çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ"
	"åªè¯»å–`/etc/zshenv`æ–‡ä»¶ï¼Œä¸ä¼šè¯»å–å…¶ä»–æ–‡ä»¶ã€‚">>